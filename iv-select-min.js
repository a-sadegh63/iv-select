$(document).on("click",".iv-select-text",function(a){$(a.target).next(".iv-select-value").prop("disabled")||ivSelectDropDown($(a.target),!0,!1)});const ivSelectOninvalid=async(b,c)=>{var a=$(b).iv_textEl();a.attr("title",c);var d=a.offset(),e=a.outerWidth();0!=a.next("span.iv-tooltip").length&&a.next("span.iv-tooltip").remove(),a.after($('<span style="position:absolute;background-color:#42414d;color:white;font-size:13px;padding:18px;left:'+d.left+"px;width:"+e+'px" class="iv-tooltip w3-round">'+c+"</span>")),$(b).on("invalid",function(){var a=$(b).iv_textEl();0!=a.next("span.iv-tooltip").length&&a.next("span.iv-tooltip").show(),a[0].getBoundingClientRect().bottom>window.innerHeight&&a[0].scrollIntoView(!1),a[0].getBoundingClientRect().top<0&&a[0].scrollIntoView()})};function ivSelectDropDown(b,c=!0,d=!1){var a=b.nextAll("div.iv-select-options"),f=b.next("input.iv-select-search"),e=a.children("option");setTimeout(function(){f.focus()},100),$(".iv-select-text").nextAll("div.iv-select-options").not(a).hide(),c&&e.show(),a.is(":hidden")?(a.show(),a.css({position:"absolute",width:b.outerWidth()+"px"}),a.hide(),a.show(200)):d&&a.hide(200),$("div.iv-select-options").not(a).hide(200)}function addIvItem(c,d){var a=$("<div/>").attr({class:"iv-selected-item w3-card w3-blue-gray w3-round w3-small"});a.data("iv_itemValue",d),a.css("width","fit-content");var b=$("<span/>").attr({class:"w3-padding-small"});b.html(c+"&nbsp;");var e=$("<i/>").attr({class:"fas fa-times iv-del-item w3-red w3-padding-small w3-hover-black",style:"cursor:pointer;border-bottom-left-radius:4px;border-top-left-radius:4px;"});return a.append(b,e)}jQuery.propHooks.disabled={set:function(a,b){$(a).is_ivSelect()&&(b?$(a).iv_textEl().css("background-color","#d5d5d5"):$(a).iv_textEl().css("background-color","white"))}},$(document).on("click",".iv-select-options option",function(d){var a=$(d.target),c=a.parent().parent().find(".iv-select-value"),e=a.parent().parent().find(".iv-select-search");if(!0===c.prop("multiple")){var b=c.val();Array.isArray(b)||(b=[b]);let f=b.indexOf(a.val());-1==f&&(b.push(a.val()),c.val(b))}else c.val(a.val());c.trigger("change"),a.data("iv_closeAfterClick")&&a.parent().hide(200),e.val("")}),$(document).on("click",".iv-del-item",function(f){var c=$(f.target),a=c.parent().parent().nextAll("select.iv-select-value");if(!a.prop("disabled")){var d=c.parent(),g=d.data("iv_itemValue");if(!0===a.prop("multiple")){var b=a.val();if(Array.isArray(b)){let e=b.indexOf(g);-1!=e&&(b.splice(e,1),a.val(b))}else a.val([])}else a.val("");a.trigger("change"),a.parent().find(".iv-select-options").hide(200),d.remove()}}),$(document).on("keyup",".iv-select-search",function(d){var b=$(d.target),e=b.val(),a=b.parent("div.iv-select-options").children("option");a.removeClass("w3-border-bottom"),a.hide();let c=a.filter(b=>$(a[b]).text().toLowerCase().indexOf(e.toLowerCase())> -1);c.show(),c.last().addClass("w3-border-bottom")}),$(document).on("click",function(){0==$(".iv-select-options:hover").length&&0==$(".iv-select-text:hover").length&&0==$(".iv-select-icon:hover").length&&0==$(".iv-select-search:hover").length&&$(".iv-select-options").hide(200),0==$(".iv-tooltip:hover").length&&setTimeout(function(){$(".iv-tooltip").hide()},3e3)}),function($){var a=$.fn.val;$.fn.val=function(b){if(!this.hasClass("iv-select-value")|| void 0===b)return a.apply(this,arguments);var d=this.nextAll("div.iv-select-options").children("option"),e=this.prevAll("div.iv-select-text"),c=[],f="";!0!==this.prop("multiple")&&Array.isArray(b)&&(b=b[0]),d.each(function(){Array.isArray(b)?-1!=b.indexOf($(this).val())?($(this).removeClass("w3-white"),$(this).addClass("w3-light-gray"),c.push(addIvItem($(this).text(),$(this).val())),$(this).prop("selected",!0),f+=$(this)[0].outerHTML):($(this).prop("selected",!1),$(this).addClass("w3-white"),$(this).removeClass("w3-light-gray")):$(this).val()==b?($(this).removeClass("w3-white"),$(this).addClass("w3-light-gray"),c.push(addIvItem($(this).text(),$(this).val())),$(this).prop("selected",!0),f+=$(this)[0].outerHTML):($(this).prop("selected",!1),$(this).addClass("w3-white"),$(this).removeClass("w3-light-gray"))}),0===c.length&&(c="&nbsp;"),this.empty().append(f),e.empty().append(c),a.apply(this,arguments)}}(jQuery),$.fn.extend({iv_updateOptions:function(a){this.hasClass("iv-select-value")&&this.nextAll("div.iv-select-options").empty().append(a)},iv_getOptions:function(){if(this.hasClass("iv-select-value")){var a=this.nextAll("div.iv-select-options").children("option"),b="";return a.each(function(){$(this).removeAttr("style"),$(this).removeAttr("class"),b+=this.outerHTML}),b}},iv_getValuesArray:function(){if(!this.hasClass("iv-select-value"))return;var a=this.nextAll("div.iv-select-options").children("option");let b=[];return a.each(function(){b.push(this.value)}),b},iv_cloneSelect:function({name:c,id:b="",placeholder:d="\u0628\u0631\u0627\u06CC \u062C\u0633\u062A\u062C\u0648 \u062A\u0627\u06CC\u067E \u0646\u0645\u0627\u06CC\u06CC\u062F",text_el_class:e="w3-input w3-border",text_el_style:f="min-width:200px;background-color:white;",container_class:g="",container_style:h="",options_container_class:i="",options_container_style:j="",option_class:l="w3-block w3-button w3-hover-blue w3-border-left w3-border-right",option_style:m="",remove_unselected:k=!0,close_after_click:n=!0}={}){if(this.hasClass("iv-select-value")){var o=this.val(),a=this.parent("div.iv-select").clone();return a.attr({class:"iv-select "+g,style:h}),a.children("select.iv-select-value").attr("name",c),""!=b?a.children("select.iv-select-value").attr("id",b):a.children("select.iv-select-value").removeAttr("id"),!0===a.children("select.iv-select-value").prop("multiple")&&a.children("select.iv-select-value").children("option").each(function(){$(this).attr("selected",!0)}),a.children("input.iv-select-search").attr("placeholder",d),a.children("div.iv-select-text").attr({class:"iv-select-text "+e,style:f}),a.children("div.iv-select-options").attr({class:"iv-select-options "+i,style:j}),k&&a.children("div.iv-select-options").children("option").filter(function(){$(this).val()!=o&&$(this).remove()}),a.children("div.iv-select-options").children("option").each(function(){$(this).attr("style",m),$(this).addClass(l),$(this).data("iv_closeAfterClick",n)}),a}},is_ivSelect:function(){return!!this.hasClass("iv-select-value")},iv_textEl:function(){return!!this.hasClass("iv-select-value")&&this.prevAll("div.iv-select-text")},iv_isIvConstruct:function(){return!!this.hasClass("iv-select-search")},iv_selectConvert:function({placeholder:a="\u0628\u0631\u0627\u06CC \u062C\u0633\u062A\u062C\u0648 \u062A\u0627\u06CC\u067E \u0646\u0645\u0627\u06CC\u06CC\u062F",style_for_text:b="",class_for_text:c="w3-input w3-border",class_for_search:d="w3-block",search_style:e="",class_for_value:f="",class_for_container:g="",class_for_opts_container:h="",style_for_opts_container:i="",class_for_options:j="w3-block w3-button w3-hover-blue w3-border-left w3-border-right",option_style:k="",keep_existing_class:l="toValue",close_after_click:m=!0,no_search_element:n=!1}={}){0!=this.length&&this.each(function(){var v,w,o={placeholder:a,style_for_text:b,class_for_text:c,class_for_search:d,search_style:e,class_for_value:f,class_for_container:g,class_for_opts_container:h,style_for_opts_container:i,class_for_options:j,option_style:k,keep_existing_class:l,close_after_click:m,no_search_element:n},q="",p=$(this);if("SELECT"==p[0].tagName&&!p.hasClass("iv-select-value")){if(void 0!==(q=p.attr("class"))&&""!=q)switch(o.keep_existing_class){case"toValue":o.class_for_value+=" "+q;break;case"toText":o.class_for_text+=" "+q;break;case"toContainer":o.class_for_container+=" "+q}var x=p.val(),r=p.children("option");r.last().addClass("w3-border-bottom"),r.each(function(){$(this).addClass(o.class_for_options),$(this).attr("style",o.option_style)}),!0===p.prop("multiple")&&(v="multiple");var s=$("<div/>").attr({class:"iv-select "+o.class_for_container}),t=p.attr("tabindex");"undefined"!==t&& !1!==t&&(s.attr("tabindex",t),p.removeAttr("tabindex"));var y=$("<div/>").attr({class:"iv-select-text "+o.class_for_text,style:"min-width:200px;background-color:white;"+o.style_for_text});if(!o.no_search_element)var z=$("<input>").attr({class:"iv-select-search "+o.class_for_search,autocomplete:"off",style:o.search_style,placeholder:o.placeholder});var A=p[0].attributes;$.each(A,function(d,a){var b=a.name,c=a.nodeValue;void 0===w?w=$("<select>").attr({[b]:c}):w.attr({[b]:c})}),w.attr({style:"display:none;",class:"iv-select-value "+o.class_for_value,multiple:v});var u=$("<div/>").attr({class:"iv-select-options "+o.class_for_opts_container,style:"display:none;"+o.style_for_opts_container});r.data("iv_closeAfterClick",o.close_after_click),o.no_search_element?u.append(r):u.append(z,r),s.append(y,w,u),void 0!==p.data("iv-init-value")&&(x=p.data("iv-init-value")),s.find("select.iv-select-value").val(x),p.replaceWith(s)}})}})