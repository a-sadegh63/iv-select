<!DOCTYPE html>
<html dir="ltr">

<head>
	<meta charset="utf-8">
	<link href="https://www.w3schools.com/w3css/4/w3.css" rel="stylesheet" type="text/css">
	<link href="style.css" rel="stylesheet" type="text/css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"
		integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<script src="./iv-select.js" type="text/javascript"></script>
</head>

<body style="background-color:#1d2a35;color:white;">

	<h1 class="w3-padding">iv_select</h1>
	<h2 class="w3-padding">iv-select is a simple, light and fast jQuery replacement for html select boxes</h2>
	<div class="w3-container w3-padding w3-margin w3-border w3-round w3-row">
		<h3>HTML select</h3>
		<div class="w3-half">
			<p>Without iv_select</p>
			<label for="cars">Choose a car:</label>
			<select name="cars" id="cars-1">
				<option value="volvo">Volvo</option>
				<option value="saab">Saab</option>
				<option value="opel">Opel</option>
				<option value="audi">Audi</option>
			</select>
		</div>
		<div class="w3-half">
			<p>With iv_select</p>
			<label for="cars">Choose a car:</label>
			<select name="cars" id="cars-2">
				<option value="volvo">Volvo</option>
				<option value="saab">Saab</option>
				<option value="opel">Opel</option>
				<option value="audi">Audi</option>
			</select>
		</div>
	</div>
	<br><br>
	<div class="w3-container w3-padding w3-margin w3-border w3-round w3-row">
		<h3>Multiple HTML select</h3>
		<div class="w3-half">
			<p>Without iv_select</p>
			<label for="cars">Choose a car:</label>
			<select name="cars" id="cars-3" multiple>
				<option value="volvo">Volvo</option>
				<option value="saab">Saab</option>
				<option value="opel">Opel</option>
				<option value="audi">Audi</option>
			</select>
		</div>
		<div class="w3-half">
			<p>With iv_select</p>
			<label for="cars">Choose a car:</label>
			<select name="cars" id="cars-4" multiple>
				<option value="volvo">Volvo</option>
				<option value="saab">Saab</option>
				<option value="opel">Opel</option>
				<option value="audi">Audi</option>
			</select>
		</div>
	</div>
	<br><br>
	<div class="w3-container w3-padding w3-margin w3-border w3-round w3-row">
		<h3>Initialize Value for Multiple HTML select</h3>
		<div class="w3-half">
			<p>Initialize Value for HTML select ( <code class="w3-light-gray">data-iv-init-value="opel"</code> )</p>
			<label for="cars">Choose a car:</label>
			<select name="cars" id="cars-6" data-iv-init-value="opel">
				<option value="volvo">Volvo</option>
				<option value="saab">Saab</option>
				<option value="opel">Opel</option>
				<option value="audi">Audi</option>
			</select>
		</div>
		<div class="w3-half">
			<p>Initialize Value for Multiple HTML select ( <code class="w3-light-gray">data-iv-init-value="saab|audi"</code> )</p>
			<label for="cars">Choose a car:</label>
			<select name="cars" id="cars-7" multiple data-iv-init-value="saab|audi">
				<option value="volvo">Volvo</option>
				<option value="saab">Saab</option>
				<option value="opel">Opel</option>
				<option value="audi">Audi</option>
			</select>
		</div>
	</div>
	<br><br>
	<form id="form-1" style="width:500px;" class="w3-container w3-padding w3-margin w3-border w3-round w3-row">
		<h3>Validate iv_select value</h3>
		<label for="cars">Choose a car:</label>
		<select name="cars" id="cars-5" data-iv-init-value="">
			<option value="volvo">Volvo</option>
			<option value="saab">Saab</option>
			<option value="opel">Opel</option>
			<option value="audi">Audi</option>
		</select>
		<button id="validate" type="submit" class="w3-button w3-green w3-right w3-round">submit</button>
	</form>
	<div style="padding-bottom:128px;"></div>

	<script>

		$('#cars-2, #cars-6, #cars-7, #cars-4').iv_selectConvert( {text_el_style:'width:80%!important;'} );
		$('#cars-5').iv_selectConvert( {text_el_style:'width:300px'} );
		$('#cars-4').val(['volvo', 'saab']);

		$('#form-1').on('submit', function (e) {
			if ( ! $('#cars-5').val() ) {
				$('#cars-5').attr( 'data-customvalidity', 'please choose a car from list' );
			}
			if ( validateElements(this) ) {
				alert('value of the iv_select is valid');
			} 
			e.preventDefault();
		});

		function validateElements(form) {
			const matches = form.querySelectorAll("[data-customvalidity]");
			console.log(matches)
			var error = false;
			matches.forEach(async (match) => {
				var err_message = match.dataset.customvalidity;
				match.setCustomValidity(err_message);
				match.reportValidity();
				error = true;
				if (match.classList.contains('iv-select-value')) {
					match.addEventListener("invalid", await ivSelectOninvalid(match, err_message));
				}
			});
			if (error) {
				setTimeout(function () {
					form.reportValidity();
				}, 800);
				return false;
			} else {
				return true;
			}
		}

	</script>

</body>

</html>